---
layout: default
title: QR2Web with GPS
---

<script>
    function onQR2WebCodeScan(barcode) {
        document.getElementById("scanResult").innerHTML = barcode;
    }
    function onQR2WebLocation(json) {
        let mapData;
        const scanResult = document.getElementById("scanResult");
        scanResult.innerHTML += " (";
        try {   
            mapData = JSON.parse(json);
        }
        catch {
            mapData = {}
        }
        scanResult.innerHTML += parseInt(mapData.latitude) + "/" + parseInt(mapData.longitude);
        if(typeof mapData.longitude == 'undefined' || mapData.longitude == '0') {scanResult.innerHTML += " - no pos"; return;}

        mapboxgl.accessToken = 'pk.eyJ1IjoiYWRyaWFub3RpZ2VyIiwiYSI6ImNreGV4d2w0MjF3bDAzMmt0dXppMDA4dmQifQ.foIvIrYgCAppnBfMhGMw9Q';
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v12',
            center: [parseFloat(mapData.longitude), parseFloat(mapData.latitude)],
            zoom: 8
        });

        scanResult.innerHTML += ")";
    }
</script>
<div class="blurb">
    <h1>Example 5</h1>
    <h2>{{ page.title }}</h2>
  Activate the location (under settings) and click on the SCAN button in your app 
  or open this link: <a href="qr2web:/scan">qr2web:/scan</a>
  <br><br>
  <div id="scanResult" style="background-color:yellow;color:#00a;padding: 20px;margin: 20px;"><i> 9 - SCAN RESULT</i></div>
  
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css"/>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js"></script>
  <div id="map" style="width:80vw;height:40vh;background:yellow;max-width:100vw;color:#00a;padding:0px;margin:0 auto;">Mapbox
  </div>
</div>
